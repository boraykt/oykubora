<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>MesajlarÄ±mÄ±z</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/png" href="heart.png">
</head>
<body class="dark">

<div class="side-menu">
  <h2>MENÃœ</h2>
  <nav>
    <a href="index.html">Ana Sayfa</a>
    <a href="galeri.html">FotoÄŸraflar</a>
    <a href="mesaj.html">Mesaj BÄ±rak</a>
    <a href="anilar.html">AnÄ±larÄ±mÄ±z</a>
    <a href="mesajlar.html">Mesajlar</a>
    <a href="sonsuzluk.html">Sonsuzluk</a>
  </nav>
</div>

<div class="page-content">
  <h1>MesajlarÄ±mÄ±z</h1>
  <div id="mesajListesi"></div>
</div>

<script>
function mesajlariGoster(){
  let mesajlar = JSON.parse(localStorage.getItem("mesajlar")) || [];
  let alan = document.getElementById("mesajListesi");

  if(mesajlar.length === 0){
    alan.innerHTML = "<p>HenÃ¼z mesaj yok â¤ï¸</p>";
    return;
  }

  alan.innerHTML = "";

  mesajlar.forEach(function(m, index){
    alan.innerHTML += `
      <div class="memory" style="position:relative;">
        <strong>${m.isim}</strong>
        <p>${m.text}</p>
        <small style="color:#888;">${m.tarih}</small>

        <button onclick="tekMesajSil(${index})"
          style="
            position:absolute;
            top:15px;
            right:15px;
            background:#b3002d;
            color:white;
            border:none;
            border-radius:50%;
            width:32px;
            height:32px;
            cursor:pointer;
            font-weight:bold;
          ">
          âœ•
        </button>
      </div>
    `;
  });
}

function tekMesajSil(index){
  if(confirm("Bu mesaj silinsin mi?")){
    let mesajlar = JSON.parse(localStorage.getItem("mesajlar")) || [];
    mesajlar.splice(index, 1);
    localStorage.setItem("mesajlar", JSON.stringify(mesajlar));
    mesajlariGoster();
  }
}

mesajlariGoster();
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyC15_7m7NfYUBkrNWp9uDqw7n3IePBoE2s",
    authDomain: "oykubora-bdf60.firebaseapp.com",
    projectId: "oykubora-bdf60",
    storageBucket: "oykubora-bdf60.firebasestorage.app",
    messagingSenderId: "441769060401",
    appId: "1:441769060401:web:0a862d2e446c2458e3cd10",
    measurementId: "G-HRVVBXNKZP"
  };

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ğŸ”¥ HER MÃœÅTERÄ°YE Ã–ZEL */
const siteID = "bora-oyku";

async function mesajlariGetir() {

  const q = query(
    collection(db, "mesajlar"),
    where("siteID", "==", siteID),
    orderBy("tarih", "desc")
  );

  const querySnapshot = await getDocs(q);
  const container = document.getElementById("mesajListesi");

  querySnapshot.forEach((doc) => {
    const data = doc.data();

    container.innerHTML += `
      <div class="mesaj-kart">
        <h3>${data.isim}</h3>
        <p>${data.mesaj}</p>
      </div>
    `;
  });
}

mesajlariGetir();
</script>

</body>
</html>

